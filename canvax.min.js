/*

Canvax.JS

License information (OMv2-FO): https://github.com/omnent/omnent-licenses/blob/master/licenses/OMv2-FO.txt

Copyright 2017 Ethan Davis

Permission is hereby granted, for free, to any person obtaining a copy of this software and associated documentation files (collectively "the Software" or "THE SOFTWARE"), to (without restriction) use, modify, copy, publish, execute, distribute, sublicense, and sell the Software and to allow people who gain access to the Software to do the same as long as this entire license and the above copyright notice are included in all copies or portions of the Software.

NOTWITHSTANDING ANYTHING IN CONTRADICTION, THE AUTHORS AND COPYRIGHT HOLDERS OF THE SOFTWARE SHALL UNDER NO CIRCUMSTANCES BE HELD LIABLE FOR ANY DAMAGES, CLAIM, OR OTHER LIABILITY RELATED TO, IN CONNECTION WITH, OR CAUSED BY USE OR DISTRIBUTION OF THE SOFTWARE. THE SOFTWARE IS PROVIDED "AS-IS" AND IS NOT PROVIDED WITH WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, NONINFRINGEMENT, AND ANY WARRANTY ARISING OUR OF PRIOR COURSE OF DEALING AND USAGE OF TRADE.

*/

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},canvax={_imageCache:{},_isElement:function _isElement(a){try{return a instanceof HTMLElement}catch(b){return"object"===("undefined"==typeof a?"undefined":_typeof(a))&&a.hasOwnProperty("nodeType")}},_pointDistance:function _pointDistance(a,b){return Math.sqrt(Math.pow(Math.abs(a[0]-b[0]),2)+Math.pow(Math.abs(a[1]-b[1]),2))},_renderEntityToCanvas:function _renderEntityToCanvas(a,b){var c=a.ctx;switch(b.type){case"Rectangle":"none"!==b.backgroundColor&&(c.fillStyle=b.backgroundColor,c.fillRect(b.x,b.y,b.width,b.height)),"0"!==b.borderWeight&&"none"!==b.borderColor&&(c.strokeStyle=b.borderColor,c.lineWidth=b.borderWeight,c.strokeRect(b.x,b.y,b.width,b.height));break;case"Circle":c.beginPath(),c.arc(b.x,b.y,b.radius,0,2*Math.PI,!1),"none"!==b.backgroundColor&&(c.fillStyle=b.backgroundColor,c.fill()),"0"!==b.borderWeight&&"none"!==b.borderColor&&(c.strokeStyle=b.borderColor,c.lineWidth=b.borderWeight,c.stroke());break;case"Ellipse":var d=.5522847493,e=b.width/2*d,f=b.height/2*d,g=b.x+b.width,h=b.y+b.height,j=b.x+b.width/2,k=b.y+b.height/2;c.beginPath(),c.moveTo(b.x,k),c.bezierCurveTo(b.x,k-f,j-e,b.y,j,b.y),c.bezierCurveTo(j+e,b.y,g,k-f,g,k),c.bezierCurveTo(g,k+f,j+e,h,j,h),c.bezierCurveTo(j-e,h,b.x,k+f,b.x,k),c.closePath(),"none"!==b.backgroundColor&&(c.fillStyle=b.backgroundColor,c.fill()),"0"!==b.borderWeight&&"none"!==b.borderColor&&(c.strokeStyle=b.borderColor,c.lineWidth=b.borderWeight,c.stroke());break;case"Image":if(canvax._imageCache.hasOwnProperty(b.source))var l=canvax._imageCache[b.source];else{var l=new Image;l.src=b.source,canvax._imageCache[b.source]=l}c.drawImage(l,b.x,b.y,b.width,b.height);break;case"CustomEntity":b.entityMethod(c,b.properties);break;default:}},_renderEntitiesToCanvas:function _renderEntitiesToCanvas(a,b){for(var c=0;c<b.length;c++)canvax._renderEntityToCanvas(a,b[c])},_clearCanvas:function _clearCanvas(a,b){a.ctx.clearRect(0,0,b.width,b.height)},Renderer:function Renderer(a){var b=this;if(canvax._isElement(a)&&a.getContext)this.entities=[],this.element=a,this.ctx=a.getContext("2d"),this.add=function(c){b.entities.push(c)},this.clear=function(){b.entities=[]},this.render=function(){canvax._clearCanvas(b,b.element),canvax._renderEntitiesToCanvas(b,b.entities)};else throw new Error("element is not a canvas element.")},Rectangle:function Rectangle(a,b,c,d,e,f,g){var h=this;if("undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c&&"undefined"!=typeof d)this.type="Rectangle",this.x=a,this.y=b,this.width=c,this.height=d,this.backgroundColor=e||"none",this.borderColor=f||"#000000",this.borderWeight=g||"0px",this.setPosition=function(j,k){h.x=j,h.y=k},this.setSize=function(j,k){h.width=j,h.height=k},this.getBounds=function(){return{l:h.x-h.width/2,t:h.y+h.height/2,r:h.x+h.width/2,b:h.y-h.height/2}};else throw new Error("Missing position parameter.")},Circle:function Circle(a,b,c,d,e,f){var g=this;if("undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c)this.type="Circle",this.x=a,this.y=b,this.radius=c,this.backgroundColor=d||"none",this.borderColor=e||"#000000",this.borderWeight=f||"0px",this.setPosition=function(h,j){g.x=h,g.y=j},this.getBounds=function(){var h=g.radius/2;return{l:g.x-h,t:g.y+h,r:g.x+h,b:g.y-h}};else throw new Error("Missing position parameter.")},Ellipse:function Ellipse(a,b,c,d,e,f,g){var h=this;if("undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c&&"undefined"!=typeof d)this.type="Ellipse",this.x=a,this.y=b,this.width=c,this.height=d,this.backgroundColor=e||"none",this.borderColor=f||"#000000",this.borderWeight=g||"0px",this.setPosition=function(j,k){h.x=j,h.y=k},this.setSize=function(j,k){h.width=j,h.height=k},this.getBounds=function(){return{l:h.x-h.width/2,t:h.y+h.height/2,r:h.x+h.width/2,b:h.y-h.height/2}};else throw new Error("Missing position parameter.")},Image:function Image(a,b,c,d,e){var f=this;if("undefined"!=typeof a&&"undefined"!=typeof b&&"undefined"!=typeof c&&"undefined"!=typeof d&&e)this.type="Image",this.x=a,this.y=b,this.width=c,this.height=d,this.source=e,this.setPosition=function(g,h){f.x=g,f.y=h},this.setSize=function(g,h){f.width=g,f.height=h},this.getBounds=function(){return{l:f.x,t:f.y,r:f.x+f.width,b:f.y-f.height}};else throw new Error("Missing required Image configuration parameter.")},Entity:function Entity(a,b){if(a)this.type="CustomEntity",this.entityMethod=a,this.properties=b||{};else throw new Error("Missing entity method.")}};